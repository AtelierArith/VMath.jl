---
jupyter:
  jupytext:
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.3'
      jupytext_version: 1.11.2
  kernelspec:
    display_name: Julia 1.6.1
    language: julia
    name: julia-1.6
---

# 特異モデルの統計学

これはテキスト$\underset{\textrm{def}}{=}$ [特異モデルの統計学 (統計科学のフロンティア 岩波書店)](https://www.iwanami.co.jp/book/b260373.html) の Chapter 1 section 1 の部分について触れた日本語で記述されたお勉強ノートである.


# モチベーション

- 統計的推測のモチベーションから話を始める. $N$ 次元の $n$ 個からなる数値データ $x^n$ が与えられたとする:
$$
x^n \underset{\textrm{def}}{=} (x_1,\dots, x_n), \quad x_i \in \mathbb{R}^N.
$$
$x^n$ の上にある $n$ は冪乗の意味ではなく長さが $n$ の列(同じことではあるが $n$ 個の要素からなる組み)という程度の意味で用いている. 我々はこのデータの発生源の性質を調べたいとする. 例えば 
$$
\mu_n \underset{\textrm{def}}{=} \bar{x}_n \underset{\textrm{def}}{=} \frac{1}{n}\sum_{i=1}^n x_i
$$
という量を計算し, "それっぽい"ことをしたいわけである. "それっぽい"というのは流石に語彙力が貧弱すぎるのでもう少しちゃんとした言い方に改めよう. データの発生源が何かしらの確率分布 $q$ に従っているとし, 分布 $q$ の平均 $\mu$ は「ま〜だいたい $\mu_n$でしょう」と思うことである. さらにいろんな方法のそれっぽいことをすることでデータの発生源の分布 $q$ は平均 $\mu$ で分散が $\sigma^2$ の正規分布だろうなと思うことができる. 思うという部分はフォーマルにいえば「推測」すると言い換えられる. このように与えられたデータ $x^n$ から $q$ を推測することを統計的推測と呼ぶ. $q$ は真の分布と呼ばれることもある.


# 定式化への一歩

- 先程のべた「ま〜だいたい $\mu_n$でしょう」な言い方も依然としてラフな印象を持たれかねない.もっとフォーマルな言い方にしたい.「だいたい〜でしょう」とポロッと言ってしまうのはデータの取得（実験などで観測）をするごとに得られるデータは変化するからだ. (なるほど，語彙力が貧弱でもその辺はちゃんと考えているようだ.) データが変化するともちろん上で求めた $\mu_n$ の値はそれに応じて変わってしまう. この「変わってしまう」というのを系統的に理解したくなる. 幸い，先人の知恵によって定式化する道具が作られてきた. それは人の立場によって機械学習だったりデータサイエンスだったり統計学だったり確率論だったりする. ここでは参考にするテキスト通りに「統計学」としよう. 何にせよ共通することは程度の差があれど数学が用いられているということだ. 
- 数学を使うと直感的に出てくる「アレ」や「ソレ」というのを定式化し文章にして記述することができる. ここで出てくる語彙力不足な人でも（ある程度忍耐があれば）先人が培ってきた道具を用いて説明・語彙力を補えるはずである. もしかしたら今までにわかっていなかったことがわかってくるかもしれない. もしかしたら経験的に知られていることを見通しよく理解することができるかもしれない. それは我々に良い知見を与えることになる．


# 定式化への $N\geq 2$ 歩

- 駄文はこれぐらいにして議論の出発点を決めるために真面目に記号や予備知識の整備を進める. 例えば用語の定義をしたり，問題設定をしたり，考える対象についていくつかの仮定をおく作業である. 
- このノートブックでは上記で出てきたような $x^n$ はある $n$ 個の確率変数 (random variable) 
$$
X^n=(X_1,\dots, X_n)
$$
の実現値とみなす定式化を図る. こうすることで上記の「変わってしまう」というのを定式化できる. 例えば $\mu_n = \sum x_i/n$ としていた部分は
$\bar{X} = \sum X_i /n $ という形の確率変数の性質を調べることに帰着される. 
- $X_i$ は確率変数なのでそれが従う分布についての視点も必要になってくる. このノートブックでは $X^n=(X_1,\dots, X_n)$ に対して次の仮定を置く:
  - $X^n=(X_1,\dots, X_n)$ は独立であり, 各々の $X_i$ は同一の分布 $q$ に従うものとする. これを `i.i.d` (independently and identically distribution の略) と呼び
$$
X^n=(X_1,\dots, X_n) \underset{\textrm{i.i.d}}{\sim} q
$$
と書く.
  - $q$ を真の分布と呼ぶ. 分布とは述べているものの, 数学的な操作の際に確率密度関数として用いられる.
  - この表記はしばしば次のように濫用することがある. 例えば $X^n$ が i.i.d でであり, 分布が平均が $\mu$ で $\sigma^2$ が分散の正規分布 $\mathcal{N}(\mu, \sigma^2)$ である場合は
  $$
  X^n \underset{\textrm{i.i.d}}{\sim} \mathcal{N}(\mu, \sigma^2)
  $$ 
  のように記述する. さらに $q=\mathcal{N}(\mu, \sigma^2)$ と書いたり, 密度関数であることを明示するために $q(x) = \mathcal{N}(x; \mu, \sigma^2)$ という表記もする.


#### 命題: 

- $X^n \underset{\textrm{i.i.d}}{\sim} \mathcal{N}(\mu, \sigma^2)$ なる確率変数 $X^n=(X_1,\dots,X_n)$ に対して
$$
\bar{X} = \frac{1}{n}\sum_{i=1}^n X_i
$$
とおく. このとき次が成り立つ:
$$
\bar{X} \sim \mathcal{N}(\mu, \sigma^2/n).
$$
特に
$$
\begin{aligned}
Z_i &= \frac{1}{\sigma}(X_i - \mu), \\
\bar{Z} &= \frac{1}{n}\sum_{i=1}^n Z_i
\end{aligned}
$$
と定義すると
$$
\sqrt{n}\bar{Z} = \frac{1}{\sqrt{n}} \sum_{i=1}^n Z_i = \frac{1}{\sqrt{n}} \sum_{i=1}^n \frac{X_i - \mu}{\sigma} \sim \mathcal{N}(0, 1)
$$
となる.

- この命題は(確率変数が正規分布であることもあり)任意の $n$ について exact に成り立っている. 統計的推測のでは $n\to\infty$ の極限で対象とする統計量(確率変数)がどうなるかを知りたいことが多い. 例えば $X^n$ の平均を ($n$ を明示的に書いて) $\bar{X}^n = \sum_i X_i/n$ と書いた時に

$$
\bar{X}^1, \bar{X}^2, \bar{X}^3, \dots, \bar{X}^n \dots
$$

という確率変数がどのようなものに「収束」するのかを知りたい.「収束」と書いた理由は,確率変数は通常の数ではなく(事象 $\omega\in\Omega$) 上の $\mathbb{R}^N$ 関数なので関数としてのどのような意味で収束するのかというのを明示的に述べる必要がある.


# 収束の話

このノートブックで必要な確率変数の収束の概念について述べる. テキストに書いていないことは

```julia

```

# Reference

特異モデルについての英語のレクチャーノートは例えば下記のようなものがある. (適当にググっただけなので内容については保証しない)kkk

- http://dept.stat.lsa.umich.edu/~moulib/stat612-notes2.pdf
